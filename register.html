<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>新規登録 - もっちカジノ</title>
</head>
<body>
  <h2>新規アカウント登録</h2>
  <p>初期ポイントとして10,000もっちをプレゼント！</p>
  
  <div>
    <input type="text" id="reg-id" placeholder="ユーザーID (半角英数)"><br><br>
    <input type="text" id="reg-name" placeholder="表示名 (例: もっち太郎)"><br><br>
    <input type="email" id="reg-email" placeholder="メールアドレス"><br><br>
    <input type="password" id="reg-pass" placeholder="パスワード"><br><br>
    <button onclick="registerUser()">登録して確認メールを送信</button>
  </div>

  <p><a href="login.html">すでにアカウントをお持ちの方はこちら</a></p>

  <script>
    // ★前回のステップで取得したGASのURLに書き換えてください
    const GAS_URL = "https://script.google.com/macros/s/AKfycbyOmbY7H3r9MIDMsH4m7BifWwIknowmiE9nD44wXZVFrffQYOPr_OSvaejnyQvAdVtZNw/exec";

    async function registerUser() {
      const btn = document.querySelector('button');
      btn.disabled = true;
      btn.innerText = "通信中...";

      const data = {
        action: 'register',
        id: document.getElementById('reg-id').value,
        displayName: document.getElementById('reg-name').value,
        email: document.getElementById('reg-email').value,
        password: document.getElementById('reg-pass').value
      };

      try {
        const response = await fetch(GAS_URL, {
          method: 'POST',
          body: JSON.stringify(data),
          headers: { 'Content-Type': 'text/plain' }
        });
        const result = await response.json();
        
        if (result.success) {
          alert("登録を受け付けました！入力したメールアドレスに確認メールを送信したので、リンクをクリックして完了させてください。");
          window.location.href = "login.html";
        } else {
          alert("エラーが発生しました。");
          btn.disabled = false;
          btn.innerText = "登録して確認メールを送信";
        }
      } catch (e) {
        alert("通信エラーです。");
      }
    }
  </script>
</body>
</html>
