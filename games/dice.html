<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ã‚µã‚¤ã‚³ãƒ­ - ã‚‚ã£ã¡ã‚«ã‚¸ãƒ</title>
  <style>
    /* CSSã¯ã‚³ã‚¤ãƒ³ãƒˆã‚¹ã¨åŒæ§˜ï¼ˆçœç•¥ã—ã¦è¨˜è¼‰ã—ã¾ã™ãŒã€å®Ÿéš›ã®ãƒ•ã‚¡ã‚¤ãƒ«ã«ã¯åæ˜ ã•ã›ã¦ãã ã•ã„ï¼‰ */
    body { font-family: sans-serif; background-color: #f4f7f6; text-align: center; padding: 20px; }
    .container { max-width: 500px; margin: 0 auto; background: #fff; padding: 30px; border-radius: 10px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
    .points { font-size: 1.5em; font-weight: bold; color: #e74c3c; }
    .btn-even { background-color: #2c3e50; color: white; padding: 15px 30px; border-radius: 5px; cursor: pointer; margin: 10px; font-weight: bold; }
    .btn-odd { background-color: #e67e22; color: white; padding: 15px 30px; border-radius: 5px; cursor: pointer; margin: 10px; font-weight: bold; }
    #result-area { margin-top: 20px; padding: 15px; font-weight: bold; font-size: 1.2em; border-radius: 5px; display: none; }
    button:disabled { background-color: #bdc3c7 !important; }
  </style>
</head>
<body>
  <div class="container">
    <h2>ğŸ² ã‚µã‚¤ã‚³ãƒ­ (ä¸åŠ)</h2>
    <p>å‚åŠ è²»: 200 ã‚‚ã£ã¡ / å‹åˆ©å ±é…¬: 400 ã‚‚ã£ã¡</p>
    <div style="background: #fcf3cf; padding: 10px; border-radius: 10px; margin-bottom: 20px;">
      <p>æ‰€æŒé‡‘: <span id="display-points" class="points">---</span> ã‚‚ã£ã¡</p>
    </div>

    <p>å‡ºç›®ã¯ã€Œå¶æ•°ã€ã‹ã€Œå¥‡æ•°ã€ã‹ï¼Ÿ</p>
    <button id="btn-even" class="btn-even" onclick="playGame('å¶æ•°')">å¶æ•° (ä¸)</button>
    <button id="btn-odd" class="btn-odd" onclick="playGame('å¥‡æ•°')">å¥‡æ•° (åŠ)</button>

    <div id="result-area"></div>
    <br><a href="../index.html">ğŸ”™ ãƒã‚¤ãƒšãƒ¼ã‚¸ã«æˆ»ã‚‹</a>
  </div>

  <script>
    const GAS_URL = "https://script.google.com/macros/s/AKfycbyOmbY7H3r9MIDMsH4m7BifWwIknowmiE9nD44wXZVFrffQYOPr_OSvaejnyQvAdVtZNw/exec";
    const COST = 200;
    const REWARD = 400;

    let currentPoints = parseInt(localStorage.getItem('userPoints'));
    document.getElementById('display-points').innerText = currentPoints;

    async function playGame(bet) {
      if (currentPoints < COST) { alert("ã‚‚ã£ã¡ãŒè¶³ã‚Šã¾ã›ã‚“ï¼"); return; }
      
      document.getElementById('btn-even').disabled = true;
      document.getElementById('btn-odd').disabled = true;
      const resArea = document.getElementById('result-area');
      resArea.style.display = 'block';
      resArea.innerText = "ã‚µã‚¤ã‚³ãƒ­ã‚’æŒ¯ã£ã¦ã„ã¾ã™...";

      const dice = Math.floor(Math.random() * 6) + 1;
      const result = (dice % 2 === 0) ? 'å¶æ•°' : 'å¥‡æ•°';
      
      currentPoints -= COST;
      const isWin = (bet === result);
      if (isWin) currentPoints += REWARD;

      try {
        await fetch(GAS_URL, {
          method: 'POST',
          body: JSON.stringify({ action: 'updatePoints', id: localStorage.getItem('userId'), newPoints: currentPoints }),
          headers: { 'Content-Type': 'text/plain' }
        });
        
        localStorage.setItem('userPoints', currentPoints);
        document.getElementById('display-points').innerText = currentPoints;
        resArea.innerText = `å‡ºç›®ã¯ã€Œ${dice}ã€(${result})ï¼\n${isWin ? 'å½“ãŸã‚Šï¼ +200ã‚‚ã£ã¡' : 'ãƒã‚ºãƒ¬...'}`;
        resArea.style.backgroundColor = isWin ? '#d5f5e3' : '#fadbd8';
      } catch (e) { alert("é€šä¿¡å¤±æ•—"); }
      
      document.getElementById('btn-even').disabled = false;
      document.getElementById('btn-odd').disabled = false;
    }
  </script>
</body>
</html>
